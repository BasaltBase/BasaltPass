"use strict";(globalThis.webpackChunkbasaltpass_docs=globalThis.webpackChunkbasaltpass_docs||[]).push([[9407],{6821(e,s,t){t.r(s),t.d(s,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"integration/s2s-auth","title":"Server-to-Server (S2S) Auth","description":"S2S authentication is used when your backend service needs to access BasaltPass APIs directly, rather than on behalf of a user. This uses the Client Credentials Flow.","source":"@site/docs/integration/s2s-auth.md","sourceDirName":"integration","slug":"/integration/s2s-auth","permalink":"/BasaltPass/docs/integration/s2s-auth","draft":false,"unlisted":false,"editUrl":"https://github.com/BasaltBase/BasaltPass/tree/main/basaltpass-docs/docs/integration/s2s-auth.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"PKCE Authorization Flow","permalink":"/BasaltPass/docs/integration/pkce-flow"},"next":{"title":"Token Validation","permalink":"/BasaltPass/docs/integration/token-validation"}}');var r=t(4848),i=t(8453);const l={sidebar_position:5},a="Server-to-Server (S2S) Auth",o={},d=[{value:"Obtaining a Token",id:"obtaining-a-token",level:2},{value:"Available Scopes",id:"available-scopes",level:2},{value:"S2S API Envelope",id:"s2s-api-envelope",level:2}];function c(e){const s={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"server-to-server-s2s-auth",children:"Server-to-Server (S2S) Auth"})}),"\n",(0,r.jsxs)(s.p,{children:["S2S authentication is used when your backend service needs to access BasaltPass APIs directly, rather than on behalf of a user. This uses the ",(0,r.jsx)(s.strong,{children:"Client Credentials Flow"}),"."]}),"\n",(0,r.jsx)(s.h2,{id:"obtaining-a-token",children:"Obtaining a Token"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Request"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-http",children:"POST /api/v1/oauth/token\nContent-Type: application/x-www-form-urlencoded\n\ngrant_type=client_credentials\n&client_id={YOUR_CLIENT_ID}\n&client_secret={YOUR_CLIENT_SECRET}\n&scope=s2s.user.read s2s.rbac.read\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Response"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-json",children:'{\n  "access_token": "eyJ...",\n  "token_type": "Bearer",\n  "expires_in": 3600\n}\n'})}),"\n",(0,r.jsx)(s.h2,{id:"available-scopes",children:"Available Scopes"}),"\n",(0,r.jsx)(s.p,{children:"It is best practice to request only the scopes you need (Principle of Least Privilege)."}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{style:{textAlign:"left"},children:"Scope"}),(0,r.jsx)(s.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{style:{textAlign:"left"},children:(0,r.jsx)(s.code,{children:"s2s.user.read"})}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:"Read user profiles, lookups."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{style:{textAlign:"left"},children:(0,r.jsx)(s.code,{children:"s2s.user.write"})}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:"Update user details (careful!)."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{style:{textAlign:"left"},children:(0,r.jsx)(s.code,{children:"s2s.rbac.read"})}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:"Read roles and permissions."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{style:{textAlign:"left"},children:(0,r.jsx)(s.code,{children:"s2s.wallet.read"})}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:"Access user wallet information."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{style:{textAlign:"left"},children:(0,r.jsx)(s.code,{children:"s2s.messages.read"})}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:"Access user internal messages."})]})]})]}),"\n",(0,r.jsx)(s.h2,{id:"s2s-api-envelope",children:"S2S API Envelope"}),"\n",(0,r.jsx)(s.p,{children:"All S2S APIs return a standard envelope structure:"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Success"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-json",children:'{\n  "data": { ... },\n  "error": null,\n  "request_id": "req-123"\n}\n'})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Error"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-json",children:'{\n  "data": null,\n  "error": {\n    "code": "invalid_parameter",\n    "message": "User not found"\n  },\n  "request_id": "req-123"\n}\n'})})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453(e,s,t){t.d(s,{R:()=>l,x:()=>a});var n=t(6540);const r={},i=n.createContext(r);function l(e){const s=n.useContext(i);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),n.createElement(i.Provider,{value:s},e.children)}}}]);