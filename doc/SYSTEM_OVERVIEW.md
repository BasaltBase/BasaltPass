# BasaltPass ç³»ç»Ÿæ¦‚è§ˆ

## ğŸ¯ é¡¹ç›®çŠ¶æ€

### âœ… å·²å®Œæˆ
- **åç«¯æ¶æ„**: Go + Fiber + GORM + PostgreSQL
- **å‰ç«¯æ¶æ„**: React 18 + TypeScript + Vite + TailwindCSS  
- **OAuth2/OIDCå®ç°**: å®Œæ•´çš„æˆæƒæœåŠ¡å™¨å®ç°
- **å¤šç§Ÿæˆ·æ¶æ„**: ç§Ÿæˆ·ã€åº”ç”¨ã€OAuthå®¢æˆ·ç«¯åˆ†ç¦»è®¾è®¡
- **ç®¡ç†ç•Œé¢**: ç§Ÿæˆ·å’Œåº”ç”¨ç®¡ç†çš„å®Œæ•´å‰ç«¯é¡µé¢
- **ç¼–è¯‘çŠ¶æ€**: å‰åç«¯å‡å¯æˆåŠŸç¼–è¯‘

### ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

#### åç«¯ç»“æ„
```
basaltpass-backend/
â”œâ”€â”€ cmd/basaltpass/main.go          # ä¸»å…¥å£
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ api/router.go               # è·¯ç”±é…ç½®
â”‚   â”œâ”€â”€ auth/                       # è®¤è¯æœåŠ¡
â”‚   â”œâ”€â”€ oauth/                      # OAuth2/OIDCå®ç°
â”‚   â”œâ”€â”€ app/                        # åº”ç”¨ç®¡ç†
â”‚   â”œâ”€â”€ model/                      # æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ common/                     # å…¬å…±ä¸­é—´ä»¶
â””â”€â”€ docs/openapi.yaml              # APIæ–‡æ¡£
```

#### å‰ç«¯ç»“æ„
```
basaltpass-frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/                 # å¯å¤ç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ AdminLayout.tsx        # ç®¡ç†å¸ƒå±€
â”‚   â”‚   â””â”€â”€ LoadingSpinner.tsx     # åŠ è½½ç»„ä»¶
â”‚   â”œâ”€â”€ pages/                      # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ admin/                 # ç®¡ç†é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ TenantList.tsx     # ç§Ÿæˆ·åˆ—è¡¨
â”‚   â”‚   â”‚   â”œâ”€â”€ CreateTenant.tsx   # åˆ›å»ºç§Ÿæˆ·
â”‚   â”‚   â”‚   â”œâ”€â”€ AppList.tsx        # åº”ç”¨åˆ—è¡¨
â”‚   â”‚   â”‚   â”œâ”€â”€ CreateApp.tsx      # åˆ›å»ºåº”ç”¨
â”‚   â”‚   â”‚   â””â”€â”€ OAuthClientConfig.tsx # OAuthé…ç½®
â”‚   â”‚   â””â”€â”€ auth/                  # è®¤è¯é¡µé¢
â”‚   â”œâ”€â”€ api/                       # APIå®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ contexts/                  # Reactä¸Šä¸‹æ–‡
â”‚   â””â”€â”€ types/                     # TypeScriptç±»å‹
â””â”€â”€ package.json
```

### ğŸ”‘ æ ¸å¿ƒåŠŸèƒ½

#### 1. å¤šç§Ÿæˆ·ç®¡ç†
- **ç§Ÿæˆ·åˆ›å»º**: æ”¯æŒç»„ç»‡çº§åˆ«çš„ç§Ÿæˆ·åˆ›å»º
- **ç§Ÿæˆ·é…ç½®**: è‡ªå®šä¹‰åŸŸåã€å“ç‰Œè®¾ç½®
- **ç”¨æˆ·é‚€è¯·**: ç§Ÿæˆ·çº§ç”¨æˆ·ç®¡ç†

#### 2. åº”ç”¨ç®¡ç†  
- **åº”ç”¨æ³¨å†Œ**: ä¸ºæ¯ä¸ªç§Ÿæˆ·åˆ›å»ºç‹¬ç«‹åº”ç”¨
- **åº”ç”¨é…ç½®**: é‡å®šå‘URIã€æƒé™èŒƒå›´è®¾ç½®
- **åº”ç”¨çŠ¶æ€**: å¯ç”¨/ç¦ç”¨åº”ç”¨è®¿é—®

#### 3. OAuth2/OIDCæœåŠ¡
- **æˆæƒæœåŠ¡å™¨**: å®Œæ•´çš„OAuth2å®ç°
- **å®¢æˆ·ç«¯ç®¡ç†**: åŠ¨æ€å®¢æˆ·ç«¯æ³¨å†Œ
- **ä»¤ç‰Œç®¡ç†**: è®¿é—®ä»¤ç‰Œå’Œåˆ·æ–°ä»¤ç‰Œ
- **OIDC Discovery**: æ ‡å‡†å‘ç°ç«¯ç‚¹

#### 4. è®¤è¯ä¸æˆæƒ
- **JWTè®¤è¯**: åŸºäºJWTçš„ä¼šè¯ç®¡ç†
- **RBACæƒé™**: åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶
- **ä¸­é—´ä»¶**: ç§Ÿæˆ·éš”ç¦»å’Œæƒé™éªŒè¯

### ğŸŒ APIç«¯ç‚¹

#### è®¤è¯ç›¸å…³
- `POST /api/v1/auth/login` - ç”¨æˆ·ç™»å½•
- `POST /api/v1/auth/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /api/v1/auth/logout` - ç”¨æˆ·ç™»å‡º

#### ç§Ÿæˆ·ç®¡ç† (éœ€è¦ç§Ÿæˆ·ç®¡ç†å‘˜æƒé™)
- `GET /api/v1/admin/tenant` - è·å–ç§Ÿæˆ·ä¿¡æ¯
- `PUT /api/v1/admin/tenant` - æ›´æ–°ç§Ÿæˆ·ä¿¡æ¯
- `POST /api/v1/admin/tenant/users/invite` - é‚€è¯·ç”¨æˆ·

#### åº”ç”¨ç®¡ç† (éœ€è¦ç§Ÿæˆ·ç®¡ç†å‘˜æƒé™)
- `POST /api/v1/admin/apps` - åˆ›å»ºåº”ç”¨
- `GET /api/v1/admin/apps` - è·å–åº”ç”¨åˆ—è¡¨
- `GET /api/v1/admin/apps/:id` - è·å–åº”ç”¨è¯¦æƒ…
- `PUT /api/v1/admin/apps/:id` - æ›´æ–°åº”ç”¨
- `DELETE /api/v1/admin/apps/:id` - åˆ é™¤åº”ç”¨

#### OAuth2å®¢æˆ·ç«¯ç®¡ç†
- `POST /api/v1/admin/oauth/clients` - åˆ›å»ºOAuthå®¢æˆ·ç«¯
- `GET /api/v1/admin/oauth/clients` - è·å–å®¢æˆ·ç«¯åˆ—è¡¨
- `PUT /api/v1/admin/oauth/clients/:id` - æ›´æ–°å®¢æˆ·ç«¯
- `DELETE /api/v1/admin/oauth/clients/:id` - åˆ é™¤å®¢æˆ·ç«¯

#### OAuth2æˆæƒæµç¨‹
- `GET /api/v1/oauth/authorize` - æˆæƒç«¯ç‚¹
- `POST /api/v1/oauth/token` - ä»¤ç‰Œç«¯ç‚¹
- `GET /api/v1/oauth/userinfo` - ç”¨æˆ·ä¿¡æ¯ç«¯ç‚¹
- `GET /.well-known/openid_configuration` - OIDCå‘ç°ç«¯ç‚¹

### ğŸš€ å¿«é€Ÿå¼€å§‹

#### 1. ç¯å¢ƒè¦æ±‚
- Go 1.21+
- Node.js 18+
- PostgreSQL 12+

#### 2. å¯åŠ¨å¼€å‘ç¯å¢ƒ
```powershell
# ä½¿ç”¨æä¾›çš„å¯åŠ¨è„šæœ¬
.\start_dev.ps1

# æˆ–æ‰‹åŠ¨å¯åŠ¨
# åç«¯
cd basaltpass-backend
go run cmd/basaltpass/main.go

# å‰ç«¯ (å¦ä¸€ä¸ªç»ˆç«¯)
cd basaltpass-frontend  
npm run dev
```

#### 3. è®¿é—®åœ°å€
- **å‰ç«¯**: http://localhost:5173
- **åç«¯API**: http://localhost:8080
- **å¥åº·æ£€æŸ¥**: http://localhost:8080/health
- **OIDCå‘ç°**: http://localhost:8080/.well-known/openid_configuration

### ğŸ“ ä¸‹ä¸€æ­¥å¼€å‘è®¡åˆ’

#### ä¼˜å…ˆçº§ 1 (æ ¸å¿ƒåŠŸèƒ½)
- [ ] æ•°æ®åº“è¿ç§»å’Œåˆå§‹åŒ–è„šæœ¬
- [ ] ç®¡ç†å‘˜ç”¨æˆ·åˆ›å»ºè„šæœ¬
- [ ] OAuth2æˆæƒæµç¨‹ç«¯åˆ°ç«¯æµ‹è¯•
- [ ] å‰ç«¯è·¯ç”±å’Œæƒé™ä¿æŠ¤

#### ä¼˜å…ˆçº§ 2 (å¢å¼ºåŠŸèƒ½)
- [ ] é‚®ä»¶æœåŠ¡é›†æˆï¼ˆç”¨æˆ·é‚€è¯·ã€å¯†ç é‡ç½®ï¼‰
- [ ] å®¡è®¡æ—¥å¿—ç•Œé¢
- [ ] ç”¨æˆ·ç®¡ç†ç•Œé¢
- [ ] æƒé™ç®¡ç†ç•Œé¢

#### ä¼˜å…ˆçº§ 3 (é«˜çº§åŠŸèƒ½)
- [ ] å¤šå› ç´ è®¤è¯(2FA)
- [ ] WebAuthnæ”¯æŒ
- [ ] ç¤¾äº¤ç™»å½•é›†æˆ
- [ ] APIé™æµå’Œç›‘æ§

### ğŸ”§ å¼€å‘å·¥å…·

#### æµ‹è¯•è„šæœ¬
- `test_complete_system.ps1` - å®Œæ•´ç³»ç»Ÿæµ‹è¯•
- `start_dev.ps1` - å¼€å‘ç¯å¢ƒå¯åŠ¨
- `test_*.ps1` - å„ç§APIæµ‹è¯•è„šæœ¬

#### é…ç½®æ–‡ä»¶
- `docker-compose.yml` - Dockerå¼€å‘ç¯å¢ƒ
- `frontend.Dockerfile` / `backend.Dockerfile` - å®¹å™¨åŒ–éƒ¨ç½²
- `docs/openapi.yaml` - APIæ–‡æ¡£

### ğŸ“š æŠ€æœ¯æ ˆè¯¦æƒ…

#### åç«¯æŠ€æœ¯æ ˆ
- **Webæ¡†æ¶**: Fiber (é«˜æ€§èƒ½HTTPæ¡†æ¶)
- **ORM**: GORM (Goè¯­è¨€ORM)
- **æ•°æ®åº“**: PostgreSQL
- **è®¤è¯**: JWT + è‡ªå®šä¹‰ä¸­é—´ä»¶
- **OAuth2**: è‡ªå®ç°OAuth2/OIDCæœåŠ¡å™¨

#### å‰ç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: React 18 (å‡½æ•°ç»„ä»¶ + Hooks)
- **ç±»å‹ç³»ç»Ÿ**: TypeScript
- **æ„å»ºå·¥å…·**: Vite
- **æ ·å¼**: TailwindCSS
- **è·¯ç”±**: React Router v6
- **HTTPå®¢æˆ·ç«¯**: Axios
- **å›¾æ ‡**: Heroicons

#### æ•°æ®åº“è®¾è®¡
- **å¤šç§Ÿæˆ·éš”ç¦»**: åŸºäºtenant_idçš„è¡Œçº§å®‰å…¨
- **OAuth2æ¨¡å‹**: æ ‡å‡†OAuth2æ•°æ®æ¨¡å‹
- **å®¡è®¡æ—¥å¿—**: æ“ä½œå®¡è®¡å’Œå®‰å…¨æ—¥å¿—
- **å…³ç³»è®¾è®¡**: å¤–é”®çº¦æŸå’Œçº§è”åˆ é™¤

è¿™ä¸ªç³»ç»Ÿç°åœ¨å·²ç»å…·å¤‡äº†å®Œæ•´çš„OAuth2/OIDCèº«ä»½æä¾›å•†çš„åŸºç¡€æ¶æ„ï¼Œå¯ä»¥ä¸ºå¤šç§Ÿæˆ·ç¯å¢ƒæä¾›å®‰å…¨çš„èº«ä»½è®¤è¯å’ŒæˆæƒæœåŠ¡ã€‚
